<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QuickLex</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#40E0D0" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <link href="https://fonts.googleapis.com/css2?family=Vazir&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container" id="mainContainer">
    <div class="header">
      <div class="logo">
        <img src="logo-symbol.png" alt="Logo" />
        <span>QuickLex</span>
      </div>
      <label class="switch">
        <input type="checkbox" id="toggleMode" />
        <span class="slider">
          <span class="quick">Quick</span>
          <span class="pro">Pro</span>
        </span>
      </label>
    </div>

    <div class="search-box">
      <input type="text" id="searchInput" placeholder="...Enter a word in English/Farsi" />
    </div>

    <div class="result-area" id="resultArea"></div>
  </div>

  <script>
    const toggle = document.getElementById('toggleMode');
    const container = document.getElementById('mainContainer');
    const searchInput = document.getElementById('searchInput');
    const resultArea = document.getElementById('resultArea');

    toggle.addEventListener('change', () => {
      const isPro = toggle.checked;
      container.classList.toggle('pro-mode', isPro);
      const endpoint = isPro
        ? "https://celebrated-beauty-production.up.railway.app/webhook/ebce61bb-fb95-468c-967d-f5c5bb6b44f1"
        : "https://celebrated-beauty-production.up.railway.app/webhook/5131686e-9341-4559-a4db-e8a7b11c01c5";
      searchInput.dataset.url = endpoint;
    });

    searchInput.addEventListener('keydown', async (e) => {
      if (e.key === 'Enter') {
        const word = searchInput.value.trim();
        const url = searchInput.dataset.url;
        if (!word || !url) return;

        const res = await fetch(url, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ word })
        });
        const data = await res.text();
        resultArea.innerText = data;

        // Auto layout fix
        requestAnimationFrame(() => {
          const lines = resultArea.innerText.split('\n');
          const updatedLines = [];
          for (let i = 0; i < lines.length; i++) {
            updatedLines.push(lines[i]);
            if (/^([ðŸ“šðŸƒðŸ’¼ðŸ âœï¸âšªï¸â˜‘ï¸])/.test(lines[i])) {
              updatedLines.push('', '');
            }
          }
          resultArea.innerText = updatedLines.join('\n');
        });
      }
    });
  </script>
</body>
</html>
